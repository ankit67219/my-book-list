<p>book-users works!</p>

<!-- User Info Section -->
<div class="user-info" *ngIf="currentUsername">
  <h3>Welcome, {{ currentUsername }}!</h3>
  <p>This is your personal book list.</p>
  
  <!-- Add Book Button -->
  <button class="add-book-btn" (click)="openAddBookModal()">+ Add New Book</button>
  
  <!-- Book Statistics -->
  <div class="book-stats" *ngIf="books.length > 0">
    <span class="stat-item">
      <strong>{{ books.length }}</strong> Total Books
    </span>
    <span class="stat-item">
      <strong>{{ getBookCountByStatus('Completed') }}</strong> Completed
    </span>
    <span class="stat-item">
      <strong>{{ getBookCountByStatus('Reading') }}</strong> Reading
    </span>
    <span class="stat-item">
      <strong>{{ getBookCountByStatus('Dropped') }}</strong> Dropped
    </span>
  </div>
</div>

<!-- Add Book Modal -->
<div class="modal-overlay" *ngIf="showAddBookModal" (click)="closeAddBookModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Add New Book</h3>
      <button class="close-btn" (click)="closeAddBookModal()">√ó</button>
    </div>
    
    <div class="modal-body">
      <form (ngSubmit)="submitAddBook()" #addBookForm="ngForm">
        <div class="form-group">
          <label for="author">Author *</label>
          <input 
            type="text" 
            id="author" 
            name="author" 
            [(ngModel)]="newBook.author" 
            required
            placeholder="Enter author name"
            class="form-control"
          />
        </div>

        <div class="form-group">
          <label for="bookTitle">Book Title *</label>
          <input 
            type="text" 
            id="bookTitle" 
            name="bookTitle" 
            [(ngModel)]="newBook.title" 
            required
            placeholder="Enter book title"
            class="form-control"
          />
        </div>

        <div class="form-group">
          <label for="status">Status</label>
          <select 
            id="status" 
            name="status" 
            [(ngModel)]="newBook.status"
            class="form-control"
          >
            <option value="Reading">Reading</option>
            <option value="Completed">Completed</option>
            <option value="Dropped">Dropped</option>
            <option value="Plan to Read">Plan to Read</option>
          </select>
        </div>

        <div class="form-group">
          <label for="notes">Notes (Optional)</label>
          <textarea 
            id="notes" 
            name="notes" 
            [(ngModel)]="newBook.notes"
            placeholder="Any additional notes about this book..."
            rows="3"
            class="form-control"
          ></textarea>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn btn-secondary" (click)="closeAddBookModal()">
            Cancel
          </button>
          <button 
            type="submit" 
            class="btn btn-primary"
            [disabled]="!newBook.author || !newBook.title"
          >
            Add Book
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Book List Table -->
<div class="book-list-container" *ngIf="books.length > 0">
  <h4>Your Book List ({{ books.length }})</h4>
  
  <!-- Search and Filter -->
  <div class="book-controls">
    <input 
      type="text" 
      [(ngModel)]="searchQuery" 
      placeholder="Search books or authors..."
      class="search-input"
      (input)="filterBooks()"
    />
    
    <div class="filter-buttons">
      <button 
        *ngFor="let status of statusFilters" 
        (click)="toggleStatusFilter(status)"
        [class.active]="activeStatusFilters.includes(status)"
        class="filter-btn"
      >
        {{ status }}
      </button>
      <button 
        (click)="clearFilters()"
        class="clear-filter-btn"
      >
        Clear Filters
      </button>
    </div>
  </div>

  <!-- Book List Table -->
  <div class="book-table">
    <div class="table-header">
      <div class="header-cell" (click)="sortBy('aname')">
        Author 
        <span *ngIf="sortColumn === 'aname'">
          {{ sortDirection === 'asc' ? '‚ñ≤' : '‚ñº' }}
        </span>
      </div>
      <div class="header-cell" (click)="sortBy('name')">
        Book Title
        <span *ngIf="sortColumn === 'name'">
          {{ sortDirection === 'asc' ? '‚ñ≤' : '‚ñº' }}
        </span>
      </div>
      <div class="header-cell" (click)="sortBy('status')">
        Status
        <span *ngIf="sortColumn === 'status'">
          {{ sortDirection === 'asc' ? '‚ñ≤' : '‚ñº' }}
        </span>
      </div>
      <div class="header-cell">Actions</div>
    </div>

    <div class="table-body">
      <div 
        *ngFor="let book of filteredBooks; let i = index" 
        class="table-row"
        [class.completed]="book.status === 'Completed'"
        [class.reading]="book.status === 'Reading'"
        [class.dropped]="book.status === 'Dropped'"
      >
        <div class="cell author-cell">{{ book.aname }}</div>
        <div class="cell title-cell">{{ book.name }}</div>
        <div class="cell status-cell">
          <span class="status-badge" [class]="book.status.toLowerCase()">
            {{ book.status }}
          </span>
        </div>
        <div class="cell actions-cell">
          <!-- <button 
            class="action-btn edit-btn"
            (click)="editBook(i)"
            title="Edit Book"
          >
            ‚úèÔ∏è
          </button>
          <button 
            class="action-btn delete-btn"
            (click)="removebook(i)"
            title="Remove Book"
          >
            üóëÔ∏è
          </button> -->
          <button 
            class="action-btn status-btn"
            (click)="changeStatus(i)"
            title="Change Status"
          >
            üîÑ
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pagination -->
  <div class="pagination" *ngIf="totalPages > 1">
    <button 
      (click)="previousPage()" 
      [disabled]="currentPage === 1"
      class="page-btn"
    >
      ‚Üê Previous
    </button>
    
    <span class="page-info">
      Page {{ currentPage }} of {{ totalPages }}
    </span>
    
    <button 
      (click)="nextPage()" 
      [disabled]="currentPage === totalPages"
      class="page-btn"
    >
      Next ‚Üí
    </button>
  </div>
</div>

<!-- Empty State -->
<div class="empty-state" *ngIf="books.length === 0 && currentUsername">
  <div class="empty-state-content">
    <h4>Your book list is empty</h4>
    <p>Start building your personal library by adding books!</p>
    <button class="add-first-book-btn" (click)="openAddBookModal()">
      + Add Your First Book
    </button>
  </div>
</div>

<!-- Logout Confirmation Modal -->
<div class="modal-overlay" *ngIf="LogoutConfirmation" (click)="cancellogout()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Confirm Logout</h3>
    </div>
    <div class="modal-body">
      <p>Are you sure you want to log out?</p>
      <div class="modal-actions">
        <button class="btn btn-secondary" (click)="cancellogout()">
          Cancel
        </button>
        <button class="btn btn-danger" (click)="confirmLogout()">
          Log Out
        </button>
      </div>
    </div>
  </div>
</div>